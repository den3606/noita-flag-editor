<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="/src/styles.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Noita Winstreak Watcher</title>
  <script type="module" src="/src/main.ts" defer></script>

  <script type="module">
    import {
      provideFluentDesignSystem,
      fluentButton,
      fluentCheckbox,
      fluentBadge,
      fluentAccordion,
      fluentAccordionItem,
      fluentCard
    } from "@fluentui/web-components";

    provideFluentDesignSystem()
      .register(
        fluentButton(),
        fluentCheckbox(),
        fluentBadge(),
        fluentAccordion(),
        fluentAccordionItem(),
        fluentCard()
      );
  </script>
</head>

<body>

  <h1>Noita Flag Editor</h1>
  <fluent-badge appearance="accent">最終実行ログ：<span id="lastExecutedLog"></span></fluent-badge>
  <fluent-badge appearance="accent">メモリ監視状況：<span id="monitorStatus">未接続</span></fluent-badge>

  <hr />
  <fluent-card class="card">
    <h2>実行</h2>
    <p>フラグを書き換えます。書き換え後は「最終実行ログ」の日時が更新されます。
      <br />起動時に一度フラグの読み込みが行われます。
    </p>
    <fluent-button id="loadFlags">フラグ読み込み</fluent-button>
    <fluent-button id="saveFlags">フラグ書き換え</fluent-button>
  </fluent-card>

  <fluent-card class="card">
    <h2>設定</h2>
    <fluent-card class="card">
      <h3>自動フラグ書き換え</h3>
      WIP:未実装
      <p>メモリを監視して、死亡判定を取得します。死亡判定が入ると、
        <br />本アプリのチェックに合わせてフラグが書き換えられます。
        <br /><u>Noitaのバージョンが変わると、動作しない可能性があります。</u>
        <br />Noitaを起動してから「自動書き換え ON」を押してください。
        <br />上部にある「メモリ監視状況」が「接続済み」になっていれば成功です。
      </p>
      <fluent-button id="startWatching" disabled>自動書き換え ON</fluent-button>
      <fluent-button id="endWatching" disabled>自動書き換え OFF</fluent-button>
    </fluent-card>

    <fluent-card class="card">
      <h3>フォルダの指定</h3>
      <p>フラグ書き換え対象のフォルダを指定します。<u>「未選択」の場合は選択してください。</u></p>
      <fluent-accordion>
        <fluent-accordion-item>
          <span slot="heading">選択したフォルダ：<span id="selectedNoitaFolderPath">未選択</span></span>
          <div class="panel">
            <p>
              <code>Nolla_Games_Noita</code> のフォルダを指定します。デフォルトでは以下に存在します。
              <br /><u><code>C:\Users\&lt;ユーザ名&gt;\AppData\LocalLow\Nolla_Games_Noita</code></u>
            </p>

            <ul>
              <li>選択済の場合、選択したフォルダに「対象フォルダのパス」が表示されます。
              </li>
              <li>未選択の場合、選択したフォルダに「未選択」が表示されます。<br />この状態ではフラグ書き換えが実行できません。
              </li>
            </ul>

            <fluent-button id="noitaFolderSelect">フォルダを選択（Nolla_Games_Noita）</fluent-button>
          </div>
        </fluent-accordion-item>
      </fluent-accordion>
    </fluent-card>
  </fluent-card>

  <fluent-card class="card">
    <h2>アンロック</h2>
    <fluent-card class="card">
      <h3>オーブアンロック</h3>

      <p>
        オーブの取得状態および呪文解放を行います。
        <br />チェックをするとオーブ取得済みの状態になります。
        <br />具体的には、 <code>flags/card_unlocked_*</code> および、 <code>orbs_new/対象のオーブ番号</code> を追加/削除します。
      </p>
      <div class="container">
        <div class="container-item">

          <fluent-checkbox id="card_unlocked_sea_lava">Orb 00 / Sea of Lava</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_crumbling_earth">Orb 01 / Earthquake</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_tentacle">Orb 02 / Tentacle</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_nuke">Orb 03 / Nuke</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_necromancy">Orb 04 / Necromancy</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_bomb_holy">Orb 05 / Holy Bomb</fluent-checkbox><br />
        </div>
        <div class="container-item">
          <fluent-checkbox id="card_unlocked_spiral_shot">Orb 06 / Spiral Shot</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_cloud_thunder">Orb 07 / Thundercloud</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_firework">Orb 08 / Fireworks!</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_exploding_deer">Orb 09 / Summon Deercoy</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_material_cement">Orb 10 / Cement</fluent-checkbox><br />
        </div>
      </div>
    </fluent-card>
    <fluent-card class="card">
      <h3>シークレットアンロック</h3>
      <p>呪文解放を行います。チェックをすると解放済の状態になります。<br />
        具体的には、 <code>flags/card_unlocked_*</code> を追加/削除します。
      </p>
      <div class="container">
        <div class="container-item">
          <fluent-checkbox id="card_unlocked_touch_grass">touch_grass</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_alchemy">alchemy</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_black_hole">black_hole</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_bomb_holy_giga">bomb_holy_giga</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_cessation">cessation</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_destruction">destruction</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_divide">divide</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_dragon">dragon</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_duplicate">duplicate</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_everything">everything</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_fish">fish</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_funky">funky</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_homing_wand">homing_wand</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_kantele">kantele</fluent-checkbox><br />
        </div>
        <div class="container-item">
          <fluent-checkbox id="card_unlocked_maggot">maggot</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_maths">maths</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_mestari">mestari</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_musicbox">musicbox</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_nukegiga">nukegiga</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_ocarina">ocarina</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_paint">paint</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_piss">piss</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_polymorph">polymorph</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_pyramid">pyramid</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_rain">rain</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_rainbow_trail">rainbow_trail</fluent-checkbox><br />
          <fluent-checkbox id="card_unlocked_sea_mimic">sea_mimic</fluent-checkbox><br />
        </div>
      </div>
    </fluent-card>
  </fluent-card>
</body>

</html>